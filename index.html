<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Teacher Absence Reporting Form 教师请假申请</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 40px auto;
      line-height: 1.5;
    }
    .class-section { 
      border: 1px solid #ddd; 
      padding: 10px; 
      margin-bottom: 10px; 
      border-radius: 8px;
    }
    .substitute-section, .makeup-section {
      display: none;
      margin-top: 6px;
      padding-left: 10px;
    }
    label {
      font-weight: 600;
      display: inline-block;
      margin-bottom: 4px;
    }
    input, select, button, textarea {
      padding: 6px;
      margin-top: 2px;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      width: auto;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 6px;
    }
    button:hover {
      background-color: #45a049;
    }
    .logo {
      display: block;
      margin: 0 auto 16px auto;
      max-width: 180px;
    }
  </style>
</head>
<body>
  <img src="0.jpg" alt="Xilin Northwest Chinese School Logo" class="logo">
  <h2>Teacher Absence Reporting Form 教师请假申请</h2>

  <form id="absenceForm" name="absenceForm" method="POST" data-netlify="true">
    <div class="form-group">
      <label for="teacherName">Teacher's Name 教师姓名:</label>
      <input type="text" id="teacherName" name="teacherName" required>
    </div>

    <div class="form-group">
      <label for="absenceDate">Date of Absence 请假日期:</label>
      <input type="date" id="absenceDate" name="absenceDate" required>
    </div>
    
    <div class="form-group">
      <label for="absenceReason">Absence Reason 请假原因:</label>
      <input id="absenceReason" name="absenceReason" placeholder="Please provide the reason for absence" required></input>
    </div>    

    <div class="form-group">
      <label for="classes">Please Enter Your Plan For Every Class You Miss 请填写受影响每一门的计划:</label>
    </div>
    
    <div id="classesContainer">
      <div class="class-section">
        <label>Class 课程 1:</label>
        <input type="text" name="classes[]" placeholder="Class name" required>

        <label>Arrangement Plan 处理安排:</label>
        <select name="absenceOptions[]" required>
          <option value="cancel">Cancel 课程取消</option>
          <option value="makeUp">Make Up 补课</option>
          <option value="substitute">Substitute Teacher 其他老师代课</option>
        </select>

        <div class="makeup-section">
          <label>Makeup Date 补课日期:</label>
          <input type="date" name="makeupDates[]" placeholder="Select makeup date" disabled>
          <label>Makeup Details 细节 (online, different time...):</label>
          <input type="text" name="makeupDetails[]" placeholder="Provide details for makeup class" disabled></input>
        </div>
        
        <div class="substitute-section">
          <label>Sub Teacher Name 代课教师:</label>
          <input type="text" name="substituteNames[]" placeholder="Enter substitute teacher name" disabled>
        </div>
      </div>
    </div>

    <button type="button" id="addClassBtn">Add Another Class 加课</button><br><br>
    <button type="submit">Submit 提交</button>
  </form>

  <script>
    // Toggle visibility for substitute and makeup fields
    function toggleFields(selectEl) {
      const classSection = selectEl.closest('.class-section');
      const subSection = classSection.querySelector('.substitute-section');
      const subInput = subSection.querySelector('input[name="substituteNames[]"]');
      const makeupSection = classSection.querySelector('.makeup-section');
      const makeupDate = makeupSection.querySelector('input[name="makeupDates[]"]');
      const makeupDetail = makeupSection.querySelector('input[name="makeupDetails[]"]'); // Changed from textarea

      if (selectEl.value === 'substitute') {
        subSection.style.display = 'block';
        subInput.disabled = false;

        makeupSection.style.display = 'none';
        makeupDate.value = '';
        makeupDate.disabled = true;
        makeupDetail.value = '';
        makeupDetail.disabled = true;
      } else if (selectEl.value === 'makeUp') {
        makeupSection.style.display = 'block';
        makeupDate.disabled = false;
        makeupDetail.disabled = false;

        subSection.style.display = 'none';
        subInput.value = '';
        subInput.disabled = true;
      } else {
        // Cancel option: hide both
        subSection.style.display = 'none';
        subInput.value = '';
        subInput.disabled = true;

        makeupSection.style.display = 'none';
        makeupDate.value = '';
        makeupDate.disabled = true;
        makeupDetail.value = '';
        makeupDetail.disabled = true;
      }
    }

    // Add a new class section dynamically
    function addClass() {
      const container = document.getElementById('classesContainer');
      const index = container.querySelectorAll('.class-section').length + 1;

      const newDiv = document.createElement('div');
      newDiv.className = 'class-section';
      newDiv.innerHTML = `
        <label>Class 课程 ${index}:</label>
        <input type="text" name="classes[]" placeholder="Class name" required>

        <label>Arrangement Plan 处理安排:</label>
        <select name="absenceOptions[]">
          <option value="cancel">Cancel 课程取消</option>
          <option value="makeUp">Make Up 补课</option>
          <option value="substitute">Substitute Teacher 其他老师代课</option>
        </select>

        <div class="makeup-section" style="display:none;">
          <label>Makeup Date 补课日期:</label>
          <input type="date" name="makeupDates[]" placeholder="Select makeup date" disabled>
          <label>Makeup Details 细节 (online, different time...):</label>
          <input type="text" name="makeupDetails[]" placeholder="Provide details for makeup class" disabled></input>
        </div>
        
        <div class="substitute-section" style="display:none;">
          <label>Sub Teacher Name 代课教师:</label>
          <input type="text" name="substituteNames[]" placeholder="Enter substitute teacher name" disabled>
        </div>
      `;

      container.appendChild(newDiv);

      // Attach event listener for the new select
      const newSelect = newDiv.querySelector('select[name="absenceOptions[]"]');
      newSelect.addEventListener('change', () => toggleFields(newSelect));

      // Initialize fields as hidden/disabled
      toggleFields(newSelect);
    }

    // Initialize listeners on load
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('select[name="absenceOptions[]"]').forEach(sel => {
        sel.addEventListener('change', () => toggleFields(sel));
        toggleFields(sel); // ensure proper initial state
      });

      document.getElementById('addClassBtn').addEventListener('click', addClass);
    });
  </script>
</body>
</html>

